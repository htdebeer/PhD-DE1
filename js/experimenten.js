// Generated by CoffeeScript 1.4.0
(function() {
  var bier_glas, bier_json, cognac_glas, cognac_json, glas, glas_en_grafiek, glas_vergelijking, knmigrafiek, life_simulation, mei_temp, mei_wind, racebaan, snelheids_bereken_tabel, toggle_klassikaal;

  mei_wind = "# DEZE GEGEVENS MOGEN VRIJ WORDEN GEBRUIKT MITS DE VOLGENDE BRONVERMELDING WORDT GEGEVEN:\n# KONINKLIJK NEDERLANDS METEOROLOGISCH INSTITUUT (KNMI)\n# \n# \n# STN         LON        LAT          ALT NAME\n# 370: 	      5.41	 51.45	     203  EINDHOVEN\n# \n# YYYYMMDD = datum (YYYY=jaar,MM=maand,DD=dag); \n# HH       = tijd (HH=uur, UT.12 UT=13 MET, 14 MEZT. Uurvak 05 loopt van 04.00 UT tot 5.00 UT; \n# FH       = Uurgemiddelde windsnelheid (in 0.1 m/s); \n# \n# STN,YYYYMMDD,   HH,   FH\n# \n  370,20120526,    1,   30\n  370,20120526,    2,   30\n  370,20120526,    3,   30\n  370,20120526,    4,   30\n  370,20120526,    5,   30\n  370,20120526,    6,   40\n  370,20120526,    7,   30\n  370,20120526,    8,   30\n  370,20120526,    9,   40\n  370,20120526,   10,   50\n  370,20120526,   11,   60\n  370,20120526,   12,   60\n  370,20120526,   13,   60\n  370,20120526,   14,   60\n  370,20120526,   15,   60\n  370,20120526,   16,   50\n  370,20120526,   17,   50\n  370,20120526,   18,   50\n  370,20120526,   19,   60\n  370,20120526,   20,   40\n  370,20120526,   21,   40\n  370,20120526,   22,   50\n  370,20120526,   23,   40\n  370,20120526,   24,   30\n  370,20120527,    1,   30\n  370,20120527,    2,   20\n  370,20120527,    3,   20\n  370,20120527,    4,   20\n  370,20120527,    5,   20\n  370,20120527,    6,   20\n  370,20120527,    7,   20\n  370,20120527,    8,   20\n  370,20120527,    9,   30\n  370,20120527,   10,   50\n  370,20120527,   11,   50\n  370,20120527,   12,   40\n  370,20120527,   13,   50\n  370,20120527,   14,   50\n  370,20120527,   15,   50\n  370,20120527,   16,   40\n  370,20120527,   17,   40\n  370,20120527,   18,   30\n  370,20120527,   19,   20\n  370,20120527,   20,   30\n  370,20120527,   21,   30\n  370,20120527,   22,   30\n  370,20120527,   23,   20\n  370,20120527,   24,   10\n  370,20120528,    1,   10\n  370,20120528,    2,   10\n  370,20120528,    3,   10\n  370,20120528,    4,   10\n  370,20120528,    5,   20\n  370,20120528,    6,   20\n  370,20120528,    7,   20\n  370,20120528,    8,   20\n  370,20120528,    9,   30\n  370,20120528,   10,   40\n  370,20120528,   11,   40\n  370,20120528,   12,   40\n  370,20120528,   13,   50\n  370,20120528,   14,   60\n  370,20120528,   15,   60\n  370,20120528,   16,   50\n  370,20120528,   17,   50\n  370,20120528,   18,   50\n  370,20120528,   19,   50\n  370,20120528,   20,   30\n  370,20120528,   21,   20\n  370,20120528,   22,   20\n  370,20120528,   23,   20\n  370,20120528,   24,   20";

  mei_temp = "# DEZE GEGEVENS MOGEN VRIJ WORDEN GEBRUIKT MITS DE VOLGENDE BRONVERMELDING WORDT GEGEVEN:\n# KONINKLIJK NEDERLANDS METEOROLOGISCH INSTITUUT (KNMI)\n# \n# \n# STN         LON        LAT          ALT NAME\n# 370: 	      5.41	 51.45	     203  EINDHOVEN\n# \n# YYYYMMDD = datum (YYYY=jaar,MM=maand,DD=dag); \n# HH       = tijd (HH=uur, UT.12 UT=13 MET, 14 MEZT. Uurvak 05 loopt van 04.00 UT tot 5.00 UT; \n# T        = Temperatuur (in 0.1 graden Celsius) op 1.50 m hoogte tijdens de waarneming; \n# \n# STN,YYYYMMDD,   HH,    T\n# \n  370,20120525,   24,  164\n  370,20120526,    1,  134\n  370,20120526,    2,  133\n  370,20120526,    3,  144\n  370,20120526,    4,  149\n  370,20120526,    5,  160\n  370,20120526,    6,  172\n  370,20120526,    7,  193\n  370,20120526,    8,  210\n  370,20120526,    9,  223\n  370,20120526,   10,  230\n  370,20120526,   11,  235\n  370,20120526,   12,  246\n  370,20120526,   13,  247\n  370,20120526,   14,  251\n  370,20120526,   15,  250\n  370,20120526,   16,  252\n  370,20120526,   17,  249\n  370,20120526,   18,  242\n  370,20120526,   19,  232\n  370,20120526,   20,  217\n  370,20120526,   21,  206\n  370,20120526,   22,  199\n  370,20120526,   23,  188\n  370,20120526,   24,  178\n  370,20120527,    1,  166\n  370,20120527,    2,  154\n  370,20120527,    3,  130\n  370,20120527,    4,  122\n  370,20120527,    5,  150\n  370,20120527,    6,  175\n  370,20120527,    7,  204\n  370,20120527,    8,  221\n  370,20120527,    9,  234\n  370,20120527,   10,  243\n  370,20120527,   11,  251\n  370,20120527,   12,  256\n  370,20120527,   13,  255\n  370,20120527,   14,  261\n  370,20120527,   15,  260\n  370,20120527,   16,  260\n  370,20120527,   17,  255\n  370,20120527,   18,  240\n  370,20120527,   19,  233\n  370,20120527,   20,  208\n  370,20120527,   21,  200\n  370,20120527,   22,  186\n  370,20120527,   23,  171\n  370,20120527,   24,  159\n  370,20120528,    1,  151\n  370,20120528,    2,  138\n  370,20120528,    3,  133\n  370,20120528,    4,  130\n  370,20120528,    5,  145\n  370,20120528,    6,  157\n  370,20120528,    7,  175\n  370,20120528,    8,  202\n  370,20120528,    9,  225\n  370,20120528,   10,  236\n  370,20120528,   11,  239\n  370,20120528,   12,  246\n  370,20120528,   13,  259\n  370,20120528,   14,  254\n  370,20120528,   15,  252\n  370,20120528,   16,  246\n  370,20120528,   17,  238\n  370,20120528,   18,  224\n  370,20120528,   19,  205\n  370,20120528,   20,  178\n  370,20120528,   21,  161\n  370,20120528,   22,  150\n  370,20120528,   23,  136\n  370,20120528,   24,  129";

  cognac_json = '{"path":"M 346 223 c 24.5 67.75 45 103.25 37 151 c -3 29 -16 78 -118 92 l 0 62 c -4 21.25 73.5 13.75 89 29","foot":{"x":255,"y":557},"stem":{"x":255,"y":528},"bowl":{"x":255,"y":466},"edge":{"x":255,"y":223},"height_in_mm":110,"spec":{"round_max":"cl","mm_from_top":0},"measure_lines":{},"nr_of_measure_lines":0}';

  bier_json = '{"path":"M 363 253 l 0 94 c 1 16.75 -3 11.25 -12 31 l -25 175 l 0 2 l 0 2","foot":{"x":255,"y":557},"stem":{"x":255,"y":555},"bowl":{"x":255,"y":553},"edge":{"x":255,"y":253},"height_in_mm":100,"spec":{"round_max":"cl","mm_from_top":0},"measure_lines":{},"nr_of_measure_lines":0}';

  cognac_glas = new Glass(cognac_json);

  bier_glas = new Glass(bier_json);

  snelheids_bereken_tabel = function(tabel_id) {
    var $height, $uitkomst, $volume;
    $height = $("#" + tabel_id + " input[name='height']");
    $volume = $("#" + tabel_id + " input[name='volume']");
    $uitkomst = $("#" + tabel_id + " input[name='uitkomst']");
    return $("#" + tabel_id + " button").click(function() {
      var floatregexp, height, speed, valid_height, valid_vol, volume;
      floatregexp = /^(([1-9]\d*([.,]\d+)?)|(0.\d+))$/;
      valid_height = false;
      valid_vol = false;
      if (floatregexp.test($height.val())) {
        $height.addClass("valid");
        $height.removeClass("invalid");
        valid_height = true;
      } else {
        $height.addClass("invalid");
        $height.removeClass("valid");
        $uitkomst.val('???');
      }
      if (floatregexp.test($volume.val())) {
        $volume.addClass("valid");
        $volume.removeClass("invalid");
        valid_vol = true;
      } else {
        $volume.addClass("invalid");
        $volume.removeClass("valid");
        $uitkomst.val('???');
      }
      if (valid_height && valid_vol) {
        height = parseFloat($height.val().replace(',', '.'));
        volume = parseFloat($volume.val().replace(',', '.'));
        speed = height / volume;
        if (isNaN(speed) || (speed === Infinity)) {
          return $uitkomst.val('???');
        } else if (speed !== Math.round(speed)) {
          return $uitkomst.val(speed.toPrecision(4).replace('.', ','));
        } else {
          return $uitkomst.val(speed.toPrecision(1));
        }
      }
    });
  };

  glas_en_grafiek = function(sectionid, width, height, glass, options) {
    var filler, paper;
    paper = Raphael("" + sectionid + "_paper", width, height);
    return filler = new Filler(paper, 0, 0, glass, width, height, options);
  };

  racebaan = function(sectionid, width, height, track, options) {
    var paper, trackracer;
    paper = Raphael("" + sectionid + "_paper", width, height);
    return trackracer = new TrackRacer(paper, 0, 0, track, width, height, options);
  };

  life_simulation = function(sectionid, width, height, config, options) {
    var paper, simulation;
    paper = Raphael("" + sectionid + "_paper", width, height);
    return simulation = new LifeSimulator(paper, 0, 0, config, width, height, options);
  };

  glas_vergelijking = function(sectionid, width, height, glazen, options) {
    var filler, paper;
    paper = Raphael("" + sectionid + "_paper", width, height);
    return filler = new CompareFiller(paper, 0, 0, glazen, width, height, options);
  };

  glas = function(sectionid, width, height, glass, options) {
    var filler, paper;
    paper = Raphael("" + sectionid + "_paper", width, height);
    return filler = new Filler(paper, 0, 0, glass, width, height, options);
  };

  knmigrafiek = function(sectionid, width, height, x_axis, y_axis, knmi_data) {
    var graph, paper;
    paper = Raphael("" + sectionid + "_paper", width, height);
    return graph = new KNMIGrapher(paper, 0, 0, width, height, x_axis, y_axis, knmi_data);
  };

  toggle_klassikaal = function(activiteit_id) {
    var _this = this;
    $("#" + activiteit_id + " :first").click(function() {
      $("#" + activiteit_id + " section").toggle();
      return $("#" + activiteit_id + " section:first").scrollintoview();
    });
    return $("#" + activiteit_id + " section").hide();
  };

  $(document).ready(function() {
    snelheids_bereken_tabel("cognac_snelheid_tabel");
    glas_en_grafiek('cognac_snelheid', 1000, 700, cognac_glas, {
      dimension: '2d',
      time: false,
      graph_buttons: ['normal', 'point', 'straight', 'curve', 'remove', 'delta', 'computer', 'raster'],
      editable: true,
      diff_graph: false,
      buttons: ['manual_diff'],
      components: ['ruler', 'tap', 'graph'],
      computer_graph: true
    });
    toggle_klassikaal("cognac");
    snelheids_bereken_tabel("cognac_tijd_snelheid_tabel");
    glas_en_grafiek('cognac_tijd_snelheid', 1000, 700, cognac_glas, {
      dimension: '2d',
      time: true,
      time_graph: true,
      editable: true,
      diff_graph: false,
      graph_buttons: ['normal', 'point', 'straight', 'curve', 'remove', 'delta', 'computer', 'raster'],
      buttons: ['manual_diff'],
      components: ['ruler', 'tap', 'graph'],
      computer_graph: true
    });
    toggle_klassikaal("cognac_tijd");
    snelheids_bereken_tabel("bier_snelheid_tabel");
    glas_en_grafiek('bier_snelheid', 1000, 700, bier_glas, {
      dimension: '2d',
      time: false,
      graph_buttons: ['normal', 'point', 'straight', 'curve', 'remove', 'delta', 'computer', 'raster'],
      editable: true,
      diff_graph: false,
      buttons: ['manual_diff'],
      components: ['ruler', 'tap', 'graph'],
      computer_graph: true
    });
    toggle_klassikaal("bier");
    snelheids_bereken_tabel("race_snelheid_tabel");
    racebaan("race_snelheid", 1200, 800, {
      path: "h-100a100,100,1,0,0,-100,100v200a50,50,1,0,0,50,50h100a60,60,1,1,0,0,-120h-40a80,80,0,0,1,0,-160h40l100,100a,50,50,0,0,0,0,-100h-50a10,10,0,0,1,0,-20h30a25,25,0,0,0,0,-50z",
      move_x: 250,
      meter_per_pixel: 0.01,
      ticks: "0.1tttttttttT",
      accelerationpath: '0.1|1,0|2.5,3|4,-2.5|5,0.1|6,-2.6|7,0|8,1|9,0|11,-2.0|11.5,2|13,-3|13.3,0|15,0.1|17'
    }, {});
    toggle_klassikaal("race");
    snelheids_bereken_tabel("populatie1_snelheid_tabel");
    life_simulation("populatie1_snelheid", 1200, 700, {
      width: 40,
      height: 40,
      initial_configuration: ['12;12', '13;12', '13;13', '14;14', '14;15', '12;15', '12;16', '13;14', '1;2', '1;1', '4;4', '15;16', '15,17', '17;18', '17;17', '3;4', '4;3', '2;2'],
      speed: 50,
      maximum_generation: 175
    }, {
      graph_buttons: ['normal', 'point', 'straight', 'curve', 'remove', 'delta', 'computer', 'raster']
    });
    toggle_klassikaal("populatie1");
    snelheids_bereken_tabel("populatie2_snelheid_tabel");
    life_simulation("populatie2_snelheid", 1200, 700, {
      width: 45,
      height: 45,
      initial_configuration: ['11;16', '13;16', '13;15', '15;14', '15;13', '15;12', '17;11', '17;12', '17;13', '18;12'],
      speed: 50,
      maximum_generation: 200
    }, {
      graph_buttons: ['normal', 'point', 'straight', 'curve', 'remove', 'delta', 'computer', 'raster']
    });
    toggle_klassikaal("populatie2");
    snelheids_bereken_tabel("weer1_snelheid_tabel");
    knmigrafiek("weer1_snelheid", 500, 500, {
      label: "uren tussen 26 en 28 mei (uur)",
      quantity: "uren",
      symbol: "uur",
      tickspath: "3tL"
    }, {
      label: "temperatuur (°C)",
      quantity: "graden Celsius",
      symbol: "°C"
    }, mei_temp);
    toggle_klassikaal("weer1");
    snelheids_bereken_tabel("weer2_snelheid_tabel");
    knmigrafiek("weer2_snelheid", 570, 500, {
      label: "uren tussen 26 en 28 mei (uur)",
      quantity: "uren",
      symbol: "uur",
      tickspath: "3tL"
    }, {
      label: "gemiddelde windsnelheid (m/sec)",
      quantity: "gemiddelde windsnelheid",
      symbol: "m/sec"
    }, mei_wind);
    toggle_klassikaal("weer2");
    return $("#start").scrollintoview();
  });

}).call(this);
